<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Earthback ‚Äî Project Designer</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap');

:root {
  --ink: #1d2a22;
  --ink80: rgba(29,42,34,.80);
  --ink60: rgba(29,42,34,.60);
  --ink40: rgba(29,42,34,.40);
  --paper: #f4efe6;
  --paper2: #efe6d7;
  --paper3: #e8dcc8;
  --moss: #2d5b45;
  --moss-light: #3a7357;
  --moss-glow: rgba(58,115,87,.15);
  --clay: #b37a4c;
  --clay-light: #c9935f;
  --amber: #d4a04a;
  --danger: #a04040;
  --white70: rgba(255,255,255,.70);
  --white50: rgba(255,255,255,.50);
  --line: rgba(29,42,34,.12);
  --radius: 16px;
  --radius-sm: 10px;
  --shadow: 0 12px 40px rgba(0,0,0,.12);
  --shadow-sm: 0 4px 16px rgba(0,0,0,.08);
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html { height: 100%; }
body {
  font-family: 'DM Sans', system-ui, sans-serif;
  color: var(--ink);
  background:
    radial-gradient(1200px 600px at 10% 0%, rgba(58,115,87,.14), transparent 55%),
    radial-gradient(1000px 600px at 90% 5%, rgba(179,122,76,.12), transparent 50%),
    linear-gradient(180deg, #1c2a22 0%, #2b3a30 200px, var(--paper) 200px);
  min-height: 100vh;
  line-height: 1.55;
}

/* ‚îÄ‚îÄ Topbar ‚îÄ‚îÄ */
.topbar {
  position: sticky; top: 0; z-index: 100;
  background: linear-gradient(180deg, rgba(22,32,26,.94), rgba(22,32,26,.80));
  backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(255,255,255,.07);
}
.topbar-inner {
  max-width: 1320px; margin: 0 auto;
  padding: 12px 24px;
  display: flex; align-items: center; justify-content: space-between; gap: 16px;
}
.brand { display: flex; align-items: center; gap: 10px; color: #eef3ee; text-decoration: none; font-weight: 700; font-size: 15px; letter-spacing: .3px; }
.mark {
  width: 32px; height: 32px; border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%),
              linear-gradient(145deg, #498a6b, #2d5b45);
  box-shadow: 0 8px 20px rgba(0,0,0,.25);
  border: 1px solid rgba(255,255,255,.18);
}
.nav-links { display: flex; gap: 6px; font-size: 13px; color: rgba(238,243,238,.7); }
.nav-links a {
  color: inherit; text-decoration: none; padding: 7px 12px;
  border-radius: 999px; border: 1px solid transparent; transition: .2s;
}
.nav-links a:hover { background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.1); }
.nav-links a.active { background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.14); color: #fff; }

/* ‚îÄ‚îÄ Page Header ‚îÄ‚îÄ */
.page-header {
  max-width: 1320px; margin: 0 auto; padding: 28px 24px 0;
}
.breadcrumb {
  font-size: 12px; color: var(--ink40); margin-bottom: 8px;
  display: flex; align-items: center; gap: 6px;
}
.breadcrumb a { color: var(--moss-light); text-decoration: none; }
.page-title {
  font-family: 'DM Serif Display', serif;
  font-size: 32px; font-weight: 400; letter-spacing: -.01em;
  margin-bottom: 4px;
}
.page-sub { color: var(--ink60); font-size: 14px; max-width: 600px; }

/* ‚îÄ‚îÄ Main Layout ‚îÄ‚îÄ */
.designer-layout {
  max-width: 1320px; margin: 20px auto 0; padding: 0 24px 60px;
  display: grid;
  grid-template-columns: 320px 1fr 280px;
  gap: 18px;
}
@media (max-width: 1100px) {
  .designer-layout { grid-template-columns: 280px 1fr; }
  .panel-right { display: none; }
}
@media (max-width: 780px) {
  .designer-layout { grid-template-columns: 1fr; }
}

/* ‚îÄ‚îÄ Cards / Panels ‚îÄ‚îÄ */
.panel {
  border-radius: var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.68), rgba(255,255,255,.52)),
              radial-gradient(600px 300px at 50% 0%, var(--moss-glow), transparent);
  border: 1px solid rgba(255,255,255,.55);
  box-shadow: var(--shadow);
  overflow: hidden;
  position: relative;
}
.panel::before {
  content: "";
  position: absolute; inset: 0;
  background: radial-gradient(circle at 10% 10%, rgba(255,255,255,.3), transparent 40%),
              repeating-linear-gradient(0deg, rgba(0,0,0,.02) 0 1px, transparent 1px 5px);
  opacity: .3; pointer-events: none;
}
.panel-header {
  position: relative;
  padding: 16px 18px 12px;
  border-bottom: 1px solid var(--line);
  display: flex; align-items: center; justify-content: space-between;
}
.panel-label {
  font-size: 11px; text-transform: uppercase; letter-spacing: .18em;
  color: var(--ink40); font-weight: 600;
}
.panel-body { position: relative; padding: 16px 18px 18px; }

/* ‚îÄ‚îÄ Steps / Stepper ‚îÄ‚îÄ */
.stepper {
  display: flex; gap: 2px; margin-bottom: 18px;
}
.step-dot {
  flex: 1; height: 4px; border-radius: 2px;
  background: var(--line); transition: .3s;
  cursor: pointer;
}
.step-dot.active { background: var(--moss); }
.step-dot.done { background: var(--moss-light); opacity: .5; }
.step-label {
  font-family: 'DM Serif Display', serif;
  font-size: 18px; margin-bottom: 4px;
}
.step-desc { font-size: 12.5px; color: var(--ink60); margin-bottom: 16px; }

/* ‚îÄ‚îÄ Form Controls ‚îÄ‚îÄ */
.field { margin-bottom: 14px; }
.field-label {
  display: block; font-size: 11.5px; font-weight: 600;
  color: var(--ink60); text-transform: uppercase; letter-spacing: .1em;
  margin-bottom: 5px;
}
.field select, .field input[type="number"], .field input[type="text"] {
  width: 100%; padding: 9px 12px;
  border: 1px solid var(--line); border-radius: var(--radius-sm);
  background: rgba(255,255,255,.6); font: inherit; font-size: 13.5px;
  color: var(--ink); transition: .2s;
}
.field select:focus, .field input:focus {
  outline: none; border-color: var(--moss-light);
  box-shadow: 0 0 0 3px var(--moss-glow);
}
.field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

/* Range slider */
.range-wrap { position: relative; }
.range-val {
  position: absolute; right: 0; top: -1px;
  font-size: 12px; font-weight: 600; color: var(--moss);
}
input[type="range"] {
  -webkit-appearance: none; width: 100%; height: 6px;
  background: linear-gradient(90deg, var(--moss) 0%, var(--moss-light) 100%);
  border-radius: 3px; outline: none; margin-top: 6px;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none; width: 18px; height: 18px;
  border-radius: 50%; background: #fff; border: 2px solid var(--moss);
  box-shadow: 0 2px 8px rgba(0,0,0,.15); cursor: pointer;
}

/* Toggle chips */
.chip-group { display: flex; flex-wrap: wrap; gap: 6px; }
.chip {
  padding: 7px 14px; border-radius: 999px;
  border: 1px solid var(--line); background: rgba(255,255,255,.5);
  font-size: 12.5px; color: var(--ink80); cursor: pointer;
  transition: .2s; user-select: none;
}
.chip:hover { border-color: var(--moss-light); background: var(--moss-glow); }
.chip.selected {
  background: var(--moss); color: #fff; border-color: var(--moss);
  box-shadow: 0 2px 8px rgba(45,91,69,.25);
}

/* ‚îÄ‚îÄ 3D Viewport ‚îÄ‚îÄ */
.viewport {
  border-radius: var(--radius);
  background:
    linear-gradient(180deg, #e8eae2, #d5d8cc),
    radial-gradient(circle at 50% 80%, rgba(58,115,87,.08), transparent);
  border: 1px solid rgba(255,255,255,.55);
  box-shadow: var(--shadow);
  overflow: hidden;
  display: flex; flex-direction: column;
  min-height: 520px;
  position: relative;
}
.viewport-toolbar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 16px;
  background: rgba(255,255,255,.45);
  border-bottom: 1px solid var(--line);
  font-size: 12px; color: var(--ink60);
  position: relative; z-index: 2;
}
.vp-tools { display: flex; gap: 4px; }
.vp-btn {
  width: 32px; height: 32px; border-radius: 8px;
  border: 1px solid var(--line); background: rgba(255,255,255,.6);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: .2s; font-size: 14px;
}
.vp-btn:hover { background: rgba(255,255,255,.9); border-color: var(--moss-light); }
.vp-btn.active { background: var(--moss); color: #fff; border-color: var(--moss); }
.viewport-canvas {
  flex: 1; position: relative; overflow: hidden;
  display: flex; align-items: center; justify-content: center;
}

/* 3D isometric building preview (CSS art) */
.building-scene {
  position: relative;
  width: 360px; height: 320px;
  transform: rotateX(0deg);
  perspective: 800px;
}
.iso-wrap {
  position: absolute; inset: 0;
  transform: rotateX(55deg) rotateZ(-45deg);
  transform-style: preserve-3d;
}
.ground-plane {
  position: absolute;
  width: 280px; height: 280px;
  left: 50%; top: 50%;
  transform: translate(-50%, -50%);
  background:
    repeating-linear-gradient(90deg, rgba(45,91,69,.08) 0 1px, transparent 1px 20px),
    repeating-linear-gradient(0deg, rgba(45,91,69,.08) 0 1px, transparent 1px 20px),
    linear-gradient(135deg, #c8d4b8, #b8c4a8);
  border-radius: 4px;
  box-shadow: 0 0 0 2px rgba(45,91,69,.12);
}
/* Building walls */
.building-base {
  position: absolute;
  left: 50%; top: 50%;
  transform: translate(-50%, -55%);
  width: 160px; height: 120px;
  background: linear-gradient(180deg, #e8d8b4, #d4c49a);
  border: 2px solid rgba(29,42,34,.15);
  border-radius: 3px;
  transform-style: preserve-3d;
  box-shadow: 0 0 30px rgba(0,0,0,.1);
}
.building-base::before {
  content: "";
  position: absolute;
  width: 100%; height: 80px;
  bottom: 100%; left: 0;
  background: linear-gradient(180deg, #d4c49a, #e8d8b4);
  border: 2px solid rgba(29,42,34,.15);
  border-bottom: none;
  transform-origin: bottom;
  transform: rotateX(0deg);
}
.roof-plane {
  position: absolute;
  left: 50%; top: 50%;
  transform: translate(-55%, -72%);
  width: 180px; height: 140px;
  background: linear-gradient(135deg, #6b8c5a, #5a7a4a);
  border: 2px solid rgba(29,42,34,.2);
  border-radius: 3px;
  box-shadow: 0 -4px 20px rgba(0,0,0,.08);
}

/* Annotation dots on viewport */
.annot {
  position: absolute; z-index: 5;
  display: flex; align-items: center; gap: 6px;
}
.annot-dot {
  width: 10px; height: 10px; border-radius: 50%;
  background: var(--moss);
  box-shadow: 0 0 0 3px rgba(45,91,69,.2), 0 2px 8px rgba(0,0,0,.15);
  animation: pulse 2s ease infinite;
}
@keyframes pulse {
  0%, 100% { box-shadow: 0 0 0 3px rgba(45,91,69,.2), 0 2px 8px rgba(0,0,0,.15); }
  50% { box-shadow: 0 0 0 8px rgba(45,91,69,.08), 0 2px 8px rgba(0,0,0,.15); }
}
.annot-label {
  font-size: 10.5px; font-weight: 600;
  background: rgba(255,255,255,.85);
  padding: 3px 8px; border-radius: 6px;
  color: var(--ink80);
  box-shadow: var(--shadow-sm);
  white-space: nowrap;
  backdrop-filter: blur(4px);
}

/* Viewport bottom info bar */
.viewport-info {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 16px; gap: 12px;
  background: rgba(255,255,255,.45);
  border-top: 1px solid var(--line);
  font-size: 11.5px; color: var(--ink60);
  position: relative; z-index: 2;
}
.dim-tag {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 4px 10px; border-radius: 6px;
  background: rgba(45,91,69,.08); color: var(--moss);
  font-weight: 600; font-size: 11px;
}

/* ‚îÄ‚îÄ Right Panel ‚îÄ‚îÄ */
.output-block {
  padding: 14px; margin-bottom: 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--line);
  background: rgba(255,255,255,.4);
}
.output-title {
  font-size: 11px; text-transform: uppercase; letter-spacing: .15em;
  color: var(--ink40); font-weight: 600; margin-bottom: 8px;
}
.output-row {
  display: flex; justify-content: space-between; align-items: center;
  font-size: 12.5px; padding: 3px 0;
}
.output-row .val { font-weight: 600; color: var(--moss); }

.export-btn {
  display: flex; align-items: center; justify-content: center; gap: 8px;
  width: 100%; padding: 11px 16px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--line);
  background: rgba(255,255,255,.5);
  font: inherit; font-size: 13px; font-weight: 600;
  color: var(--ink80); cursor: pointer; transition: .2s;
  margin-bottom: 8px;
}
.export-btn:hover { background: rgba(255,255,255,.8); border-color: var(--moss-light); }
.export-btn.primary {
  background: var(--moss); color: #fff; border-color: var(--moss);
}
.export-btn.primary:hover { background: var(--moss-light); }

.badge-row { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 6px; }
.badge {
  padding: 3px 8px; border-radius: 6px;
  font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: .08em;
}
.badge-bim { background: #e0ecf7; color: #2a6cb8; }
.badge-game { background: #f0e6f7; color: #7b3fb8; }
.badge-coord { background: #e0f0e4; color: var(--moss); }

/* ‚îÄ‚îÄ Game Mode Toggle ‚îÄ‚îÄ */
.mode-toggle {
  display: flex; border-radius: var(--radius-sm); overflow: hidden;
  border: 1px solid var(--line); background: rgba(255,255,255,.4);
}
.mode-btn {
  flex: 1; padding: 8px 0; text-align: center;
  font-size: 11px; font-weight: 600; text-transform: uppercase;
  letter-spacing: .1em; cursor: pointer; transition: .2s;
  border: none; background: transparent; color: var(--ink60);
}
.mode-btn.active-real {
  background: var(--moss); color: #fff;
}
.mode-btn.active-post {
  background: #4a3a2a; color: #d4a04a;
}

/* ‚îÄ‚îÄ Divider ‚îÄ‚îÄ */
.divider {
  height: 1px; margin: 14px 0;
  background: linear-gradient(90deg, transparent, var(--line), transparent);
}

/* ‚îÄ‚îÄ Needs List ‚îÄ‚îÄ */
.need-item {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 12px; margin-bottom: 6px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--line);
  background: rgba(255,255,255,.4);
  font-size: 12.5px;
  transition: .2s;
}
.need-item:hover { background: rgba(255,255,255,.7); }
.need-icon {
  width: 28px; height: 28px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; flex-shrink: 0;
}
.need-icon.skill { background: #e0ecf7; }
.need-icon.resource { background: #f0e6d7; }
.need-icon.people { background: #e0f0e4; }
.need-name { flex: 1; }
.need-status {
  font-size: 10px; font-weight: 600; text-transform: uppercase;
  padding: 2px 8px; border-radius: 4px;
}
.need-status.open { background: rgba(212,160,74,.15); color: var(--clay); }
.need-status.filled { background: rgba(45,91,69,.1); color: var(--moss); }

/* ‚îÄ‚îÄ Pipeline diagram ‚îÄ‚îÄ */
.pipeline {
  display: flex; align-items: center; gap: 0;
  margin: 12px 0;
}
.pipe-node {
  display: flex; flex-direction: column; align-items: center;
  flex: 1; position: relative;
}
.pipe-circle {
  width: 36px; height: 36px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: 700;
  border: 2px solid var(--line);
  background: rgba(255,255,255,.6);
  position: relative; z-index: 2;
}
.pipe-node.active .pipe-circle {
  border-color: var(--moss); background: var(--moss); color: #fff;
  box-shadow: 0 0 0 4px var(--moss-glow);
}
.pipe-label { font-size: 9px; text-transform: uppercase; letter-spacing: .1em; color: var(--ink40); margin-top: 5px; text-align: center; font-weight: 600; line-height: 1.2; }
.pipe-line {
  position: absolute; top: 18px; left: 50%; width: 100%; height: 2px;
  background: var(--line); z-index: 1;
}
.pipe-node:last-child .pipe-line { display: none; }

/* ‚îÄ‚îÄ Scrollbar ‚îÄ‚îÄ */
.panel-body::-webkit-scrollbar { width: 4px; }
.panel-body::-webkit-scrollbar-thumb { background: var(--line); border-radius: 2px; }

/* ‚îÄ‚îÄ Subtle texture overlay on whole page ‚îÄ‚îÄ */
body::after {
  content: "";
  position: fixed; inset: 0; z-index: 9999;
  pointer-events: none;
  background: url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.018'/%3E%3C/svg%3E");
  opacity: 1;
}

/* ‚îÄ‚îÄ Animations ‚îÄ‚îÄ */
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}
.panel { animation: fadeUp .5s ease both; }
.panel:nth-child(2) { animation-delay: .08s; }
.panel:nth-child(3) { animation-delay: .16s; }
.viewport { animation: fadeUp .5s ease .04s both; }
</style>
</head>
<body>

<!-- ‚îÄ‚îÄ Topbar ‚îÄ‚îÄ -->
<header class="topbar">
  <div class="topbar-inner">
    <a class="brand" href="#">
      <span class="mark" aria-hidden="true"></span>
      <span>Earthback</span>
    </a>
    <nav class="nav-links">
      <a href="#">Dashboard</a>
      <a href="#">Projects</a>
      <a href="#">Map</a>
      <a href="#">Community</a>
      <a href="#">Marketplace</a>
      <a href="#" class="active">Designer</a>
    </nav>
  </div>
</header>

<!-- ‚îÄ‚îÄ Page Header ‚îÄ‚îÄ -->
<div class="page-header">
  <div class="breadcrumb">
    <a href="#">Projects</a>
    <span>‚Ä∫</span>
    <a href="#">Eco Village Initiative</a>
    <span>‚Ä∫</span>
    <span>Design Unit A</span>
  </div>
  <h1 class="page-title">Project Designer</h1>
  <p class="page-sub">Configure your structure, preview in 3D, and generate BIM exports + game-ready assets.</p>
</div>

<!-- ‚îÄ‚îÄ Designer Layout ‚îÄ‚îÄ -->
<div class="designer-layout">

  <!-- ‚ïê‚ïê‚ïê LEFT PANEL: Configuration ‚ïê‚ïê‚ïê -->
  <div class="panel panel-left">
    <div class="panel-header">
      <span class="panel-label">Configure</span>
      <div class="mode-toggle">
        <button class="mode-btn active-real" id="modeReal" onclick="setMode('real')">Real World</button>
        <button class="mode-btn" id="modePost" onclick="setMode('post')">Post-Apoc</button>
      </div>
    </div>
    <div class="panel-body" style="max-height: calc(100vh - 220px); overflow-y: auto;">

      <!-- Stepper -->
      <div class="stepper">
        <div class="step-dot active" data-step="1"></div>
        <div class="step-dot" data-step="2"></div>
        <div class="step-dot" data-step="3"></div>
        <div class="step-dot" data-step="4"></div>
        <div class="step-dot" data-step="5"></div>
      </div>

      <!-- Step 1: Foundation -->
      <div class="step-content" id="step1">
        <div class="step-label">1 ‚Äî Foundation & Type</div>
        <div class="step-desc">Choose your building archetype and foundation system</div>

        <div class="field">
          <label class="field-label">Building Type</label>
          <select id="buildType" onchange="updatePreview()">
            <option value="dwelling">Single Dwelling (1-2 story)</option>
            <option value="multi">Multi-Unit Housing</option>
            <option value="community">Community Building</option>
            <option value="workshop">Workshop / Maker Space</option>
            <option value="greenhouse">Greenhouse / Growing</option>
            <option value="tiny">Tiny Home / Emergency Shelter</option>
          </select>
        </div>

        <div class="field">
          <label class="field-label">Construction Method</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">3D Printed Hempcrete</span>
            <span class="chip" onclick="toggleChip(this)">Manual Hempcrete</span>
            <span class="chip" onclick="toggleChip(this)">Hybrid</span>
            <span class="chip" onclick="toggleChip(this)">Conventional+Hemp</span>
          </div>
        </div>

        <div class="field">
          <label class="field-label">Foundation Type</label>
          <select>
            <option>Lime-Based Slab</option>
            <option>Pier & Beam (Hemp Timber)</option>
            <option>Rubble Trench</option>
            <option>Earthbag Stem Wall</option>
          </select>
        </div>

        <div class="field-row">
          <div class="field">
            <label class="field-label">Length (ft)</label>
            <input type="number" value="40" min="10" max="120" id="dimL" oninput="updatePreview()">
          </div>
          <div class="field">
            <label class="field-label">Width (ft)</label>
            <input type="number" value="28" min="10" max="80" id="dimW" oninput="updatePreview()">
          </div>
        </div>

        <div class="field">
          <label class="field-label">Stories</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">1</span>
            <span class="chip" onclick="toggleChip(this)">1.5</span>
            <span class="chip" onclick="toggleChip(this)">2</span>
          </div>
        </div>

        <div class="field">
          <label class="field-label">Wall Thickness</label>
          <div class="range-wrap">
            <span class="range-val" id="wallVal">12"</span>
            <input type="range" min="8" max="24" value="12" step="2" oninput="document.getElementById('wallVal').textContent=this.value+'&quot;'">
          </div>
        </div>
      </div>

      <!-- Step 2: Rooms (hidden by default, shown on step click) -->
      <div class="step-content" id="step2" style="display:none;">
        <div class="step-label">2 ‚Äî Interior Layout</div>
        <div class="step-desc">Define rooms and floor plan arrangement</div>

        <div class="field">
          <label class="field-label">Bedrooms</label>
          <div class="chip-group">
            <span class="chip" onclick="toggleChip(this)">Studio</span>
            <span class="chip" onclick="toggleChip(this)">1</span>
            <span class="chip selected" onclick="toggleChip(this)">2</span>
            <span class="chip" onclick="toggleChip(this)">3</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Bathrooms</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">1</span>
            <span class="chip" onclick="toggleChip(this)">1.5</span>
            <span class="chip" onclick="toggleChip(this)">2</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Kitchen Style</label>
          <select>
            <option>Open to Living</option>
            <option>Separated Kitchen</option>
            <option>Galley</option>
            <option>Outdoor / Summer Kitchen</option>
          </select>
        </div>
        <div class="field">
          <label class="field-label">Additional Spaces</label>
          <div class="chip-group">
            <span class="chip" onclick="toggleChip(this)">Pantry</span>
            <span class="chip" onclick="toggleChip(this)">Mudroom</span>
            <span class="chip selected" onclick="toggleChip(this)">Porch</span>
            <span class="chip" onclick="toggleChip(this)">Root Cellar</span>
            <span class="chip" onclick="toggleChip(this)">Workshop</span>
          </div>
        </div>
      </div>

      <!-- Step 3: Roof & Energy -->
      <div class="step-content" id="step3" style="display:none;">
        <div class="step-label">3 ‚Äî Roof & Energy</div>
        <div class="step-desc">Roofing system, solar integration, and energy planning</div>

        <div class="field">
          <label class="field-label">Roof Type</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">Metal (100yr)</span>
            <span class="chip" onclick="toggleChip(this)">Living Roof</span>
            <span class="chip" onclick="toggleChip(this)">Hemp Thatch</span>
            <span class="chip" onclick="toggleChip(this)">Hybrid</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Roof Pitch</label>
          <div class="range-wrap">
            <span class="range-val" id="pitchVal">6/12</span>
            <input type="range" min="2" max="12" value="6" oninput="document.getElementById('pitchVal').textContent=this.value+'/12'">
          </div>
        </div>
        <div class="field">
          <label class="field-label">Solar Integration</label>
          <div class="chip-group">
            <span class="chip" onclick="toggleChip(this)">None</span>
            <span class="chip selected" onclick="toggleChip(this)">Solar Shingles</span>
            <span class="chip" onclick="toggleChip(this)">Panel-Ready Rails</span>
            <span class="chip" onclick="toggleChip(this)">Full Array</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Climate Zone</label>
          <select>
            <option>Hot-Arid</option>
            <option>Hot-Humid</option>
            <option selected>Mixed-Humid</option>
            <option>Cold</option>
            <option>Very Cold</option>
            <option>Marine</option>
          </select>
        </div>
      </div>

      <!-- Step 4: Materials -->
      <div class="step-content" id="step4" style="display:none;">
        <div class="step-label">4 ‚Äî Materials & Finish</div>
        <div class="step-desc">Interior and exterior material selections</div>

        <div class="field">
          <label class="field-label">Exterior Finish</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">Lime Plaster</span>
            <span class="chip" onclick="toggleChip(this)">Exposed Hempcrete</span>
            <span class="chip" onclick="toggleChip(this)">Hemp Board + Plaster</span>
            <span class="chip" onclick="toggleChip(this)">Reclaimed Wood</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Interior Walls</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">Clay Plaster</span>
            <span class="chip" onclick="toggleChip(this)">Lime Plaster</span>
            <span class="chip" onclick="toggleChip(this)">Hemp Paneling</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Flooring</label>
          <div class="chip-group">
            <span class="chip selected" onclick="toggleChip(this)">Hemp Fiber</span>
            <span class="chip" onclick="toggleChip(this)">Polished Concrete</span>
            <span class="chip" onclick="toggleChip(this)">Reclaimed Hardwood</span>
            <span class="chip" onclick="toggleChip(this)">Earthen</span>
          </div>
        </div>
        <div class="field">
          <label class="field-label">Window Style</label>
          <select>
            <option>Standard Double-Hung</option>
            <option selected>Casement (passive ventilation)</option>
            <option>Clerestory</option>
            <option>Large Fixed + Operable</option>
          </select>
        </div>
      </div>

      <!-- Step 5: Export & Game -->
      <div class="step-content" id="step5" style="display:none;">
        <div class="step-label">5 ‚Äî Export & Publish</div>
        <div class="step-desc">Generate outputs for construction, coordination, and gameplay</div>

        <div class="output-title">Asset Pipeline</div>
        <div class="pipeline">
          <div class="pipe-node active">
            <div class="pipe-circle">‚òë</div>
            <div class="pipe-label">Config</div>
            <div class="pipe-line"></div>
          </div>
          <div class="pipe-node active">
            <div class="pipe-circle">‚¨°</div>
            <div class="pipe-label">Para-<br>metric</div>
            <div class="pipe-line"></div>
          </div>
          <div class="pipe-node active">
            <div class="pipe-circle">‚óà</div>
            <div class="pipe-label">BIM<br>Model</div>
            <div class="pipe-line"></div>
          </div>
          <div class="pipe-node">
            <div class="pipe-circle">‚ñ£</div>
            <div class="pipe-label">Game<br>Asset</div>
            <div class="pipe-line"></div>
          </div>
          <div class="pipe-node">
            <div class="pipe-circle">‚óâ</div>
            <div class="pipe-label">Publish</div>
          </div>
        </div>

        <div class="divider"></div>

        <button class="export-btn primary" onclick="alert('This would generate an IFC 4.0 file with full BIM data including material specs, structural elements, MEP rough-in, and energy model.')">
          ‚¨° Export IFC (BIM Standard)
        </button>
        <button class="export-btn" onclick="alert('Generates a GLTF/GLB optimized for real-time rendering with LOD levels, collision mesh, and material PBR maps.')">
          ‚ñ£ Export Game Asset (glTF)
        </button>
        <button class="export-btn" onclick="alert('Creates an Earthback Project with auto-generated Needs list, bill of materials, skill requirements, and timeline.')">
          ‚óà Create Earthback Project
        </button>
        <button class="export-btn">
          üìã Export Bill of Materials (CSV)
        </button>
        <button class="export-btn">
          üìê Export Floor Plan (DXF/SVG)
        </button>

        <div class="divider"></div>
        <div class="output-title">Sharing</div>
        <button class="export-btn">
          üîó Share Design Link
        </button>
        <button class="export-btn">
          üì¶ Submit to Template Library
        </button>
      </div>

      <!-- Nav buttons -->
      <div style="display:flex; gap:8px; margin-top:16px;">
        <button class="export-btn" id="prevBtn" onclick="changeStep(-1)" style="flex:1; display:none;">‚Üê Back</button>
        <button class="export-btn primary" id="nextBtn" onclick="changeStep(1)" style="flex:1;">Next ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê CENTER: 3D Viewport ‚ïê‚ïê‚ïê -->
  <div class="viewport">
    <div class="viewport-toolbar">
      <div class="vp-tools">
        <button class="vp-btn active" title="Orbit">‚ü≥</button>
        <button class="vp-btn" title="Pan">‚ú•</button>
        <button class="vp-btn" title="Zoom">‚äï</button>
        <button class="vp-btn" title="Measure">üìè</button>
        <button class="vp-btn" title="Section Cut">‚úÇ</button>
      </div>
      <div style="display:flex; gap:8px; align-items:center;">
        <span style="font-size:11px; opacity:.6;">View:</span>
        <button class="vp-btn" title="Top" style="font-size:10px; width:auto; padding:0 8px;">Top</button>
        <button class="vp-btn" title="Front" style="font-size:10px; width:auto; padding:0 8px;">Front</button>
        <button class="vp-btn active" title="3D" style="font-size:10px; width:auto; padding:0 8px;">3D</button>
      </div>
    </div>

    <div class="viewport-canvas" id="viewportCanvas">
      <!-- CSS Isometric Building -->
      <div class="building-scene">
        <div class="iso-wrap">
          <div class="ground-plane"></div>
          <div class="building-base" id="buildingBase"></div>
          <div class="roof-plane" id="roofPlane"></div>
        </div>
      </div>

      <!-- Annotation dots -->
      <div class="annot" style="top:22%; left:58%;">
        <div class="annot-dot"></div>
        <div class="annot-label">Metal Roof (100yr) + Solar Shingles</div>
      </div>
      <div class="annot" style="top:48%; left:18%;">
        <div class="annot-dot"></div>
        <div class="annot-label">12" Hempcrete Wall ‚Äî R-28</div>
      </div>
      <div class="annot" style="top:68%; left:55%;">
        <div class="annot-dot"></div>
        <div class="annot-label">Lime Slab Foundation</div>
      </div>
      <div class="annot" style="top:38%; right:12%;">
        <div class="annot-dot"></div>
        <div class="annot-label">Casement Windows</div>
      </div>

      <!-- Placeholder message -->
      <div style="position:absolute; bottom:16px; left:50%; transform:translateX(-50%);
           font-size:11px; color:var(--ink40); background:rgba(255,255,255,.7);
           padding:6px 14px; border-radius:8px; backdrop-filter:blur(4px); text-align:center;">
        Interactive 3D preview ‚Äî drag to orbit ¬∑ scroll to zoom<br>
        <span style="font-size:10px; opacity:.7;">Production: Three.js / IFC.js renderer with BIM model</span>
      </div>
    </div>

    <div class="viewport-info">
      <div style="display:flex; gap:8px; flex-wrap:wrap;">
        <span class="dim-tag" id="dimTag">40‚Ä≤ √ó 28‚Ä≤</span>
        <span class="dim-tag">1,120 sq ft</span>
        <span class="dim-tag">1 Story</span>
      </div>
      <div style="display:flex; gap:6px;">
        <span class="badge badge-bim">IFC 4.0</span>
        <span class="badge badge-game">glTF 2.0</span>
        <span class="badge badge-coord">Earthback</span>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê RIGHT PANEL: Outputs & Needs ‚ïê‚ïê‚ïê -->
  <div class="panel panel-right">
    <div class="panel-header">
      <span class="panel-label">Project Summary</span>
    </div>
    <div class="panel-body" style="max-height: calc(100vh - 220px); overflow-y: auto;">

      <!-- Estimates -->
      <div class="output-block">
        <div class="output-title">Material Estimates</div>
        <div class="output-row"><span>Hempcrete Volume</span><span class="val">~38 yd¬≥</span></div>
        <div class="output-row"><span>Hemp Hurd Required</span><span class="val">~8.4 tons</span></div>
        <div class="output-row"><span>Lime Binder</span><span class="val">~4.2 tons</span></div>
        <div class="output-row"><span>Concrete (structural)</span><span class="val">~12 yd¬≥</span></div>
        <div class="output-row"><span>Metal Roofing</span><span class="val">~1,320 sq ft</span></div>
        <div class="output-row"><span>Solar Shingles</span><span class="val">~480 sq ft</span></div>
      </div>

      <div class="output-block">
        <div class="output-title">Performance</div>
        <div class="output-row"><span>Wall R-Value</span><span class="val">R-28</span></div>
        <div class="output-row"><span>Est. Carbon Stored</span><span class="val">-14.2 tCO‚ÇÇ</span></div>
        <div class="output-row"><span>Fire Rating</span><span class="val">2hr+</span></div>
        <div class="output-row"><span>Est. Lifespan</span><span class="val">250+ yr</span></div>
        <div class="output-row"><span>Solar Output</span><span class="val">~6.4 kW</span></div>
      </div>

      <div class="output-block">
        <div class="output-title">Cost Estimate</div>
        <div class="output-row"><span>Materials</span><span class="val">$68,000</span></div>
        <div class="output-row"><span>Labor (community)</span><span class="val">$22,000</span></div>
        <div class="output-row"><span>Equipment</span><span class="val">$15,000</span></div>
        <div class="output-row" style="border-top:1px solid var(--line); padding-top:6px; margin-top:4px;">
          <span style="font-weight:600;">Total Estimate</span>
          <span class="val" style="font-size:14px;">$105,000</span>
        </div>
        <div class="output-row"><span>Per sq ft</span><span class="val">~$94</span></div>
      </div>

      <div class="divider"></div>

      <!-- Auto-generated Needs -->
      <div class="output-title">Auto-Generated Needs</div>
      <div style="font-size:11.5px; color:var(--ink40); margin-bottom:10px;">
        These will populate your Earthback project
      </div>

      <div class="need-item">
        <div class="need-icon skill">üéì</div>
        <div class="need-name">3D Print Operator</div>
        <div class="need-status open">Need</div>
      </div>
      <div class="need-item">
        <div class="need-icon resource">üåø</div>
        <div class="need-name">8.4 tons Hemp Hurd</div>
        <div class="need-status open">Need</div>
      </div>
      <div class="need-item">
        <div class="need-icon resource">ÔøΩite</div>
        <div class="need-name">4.2 tons Lime Binder</div>
        <div class="need-status open">Need</div>
      </div>
      <div class="need-item">
        <div class="need-icon people">üë∑</div>
        <div class="need-name">Finish Crew (4-6)</div>
        <div class="need-status open">Need</div>
      </div>
      <div class="need-item">
        <div class="need-icon skill">‚ö°</div>
        <div class="need-name">Solar Installer</div>
        <div class="need-status filled">Found</div>
      </div>
      <div class="need-item">
        <div class="need-icon resource">üî©</div>
        <div class="need-name">Metal Roofing</div>
        <div class="need-status open">Need</div>
      </div>
      <div class="need-item">
        <div class="need-icon skill">üìê</div>
        <div class="need-name">Structural Review</div>
        <div class="need-status open">Need</div>
      </div>

      <div class="divider"></div>

      <div class="output-block" style="background: rgba(123,63,184,.06); border-color: rgba(123,63,184,.15);">
        <div class="output-title" style="color:#7b3fb8;">Game Asset Status</div>
        <div class="output-row"><span>LOD Levels</span><span class="val" style="color:#7b3fb8;">3 (auto)</span></div>
        <div class="output-row"><span>Collision Mesh</span><span class="val" style="color:#7b3fb8;">Ready</span></div>
        <div class="output-row"><span>PBR Materials</span><span class="val" style="color:#7b3fb8;">Hemp / Lime / Metal</span></div>
        <div class="output-row"><span>Poly Count</span><span class="val" style="color:#7b3fb8;">~12K (LOD0)</span></div>
        <div class="badge-row">
          <span class="badge badge-game">Real-World Mode</span>
          <span class="badge" style="background:#2a2018; color:#d4a04a;">Post-Apoc Mode</span>
        </div>
      </div>

    </div>
  </div>

</div>

<script>
let currentStep = 1;
const totalSteps = 5;

function changeStep(dir) {
  const next = currentStep + dir;
  if (next < 1 || next > totalSteps) return;
  document.getElementById('step' + currentStep).style.display = 'none';
  currentStep = next;
  document.getElementById('step' + currentStep).style.display = 'block';
  
  document.querySelectorAll('.step-dot').forEach((d, i) => {
    d.className = 'step-dot';
    if (i + 1 === currentStep) d.classList.add('active');
    else if (i + 1 < currentStep) d.classList.add('done');
  });
  
  document.getElementById('prevBtn').style.display = currentStep > 1 ? 'block' : 'none';
  document.getElementById('nextBtn').textContent = currentStep === totalSteps ? '‚úì Finish' : 'Next ‚Üí';
}

// Step dot click
document.querySelectorAll('.step-dot').forEach(d => {
  d.addEventListener('click', () => {
    const target = parseInt(d.dataset.step);
    document.getElementById('step' + currentStep).style.display = 'none';
    currentStep = target;
    document.getElementById('step' + currentStep).style.display = 'block';
    document.querySelectorAll('.step-dot').forEach((dd, i) => {
      dd.className = 'step-dot';
      if (i + 1 === currentStep) dd.classList.add('active');
      else if (i + 1 < currentStep) dd.classList.add('done');
    });
    document.getElementById('prevBtn').style.display = currentStep > 1 ? 'block' : 'none';
    document.getElementById('nextBtn').textContent = currentStep === totalSteps ? '‚úì Finish' : 'Next ‚Üí';
  });
});

function toggleChip(el) {
  const group = el.parentElement;
  // For some groups, single select; for others, multi
  const isSingle = ['Stories', 'Bedrooms', 'Bathrooms'].some(
    t => group.previousElementSibling && group.previousElementSibling.textContent.includes(t)
  );
  if (isSingle) {
    group.querySelectorAll('.chip').forEach(c => c.classList.remove('selected'));
  }
  el.classList.toggle('selected');
  updatePreview();
}

function updatePreview() {
  const l = document.getElementById('dimL')?.value || 40;
  const w = document.getElementById('dimW')?.value || 28;
  document.getElementById('dimTag').textContent = l + '‚Ä≤ √ó ' + w + '‚Ä≤';
}

function setMode(mode) {
  const real = document.getElementById('modeReal');
  const post = document.getElementById('modePost');
  if (mode === 'real') {
    real.className = 'mode-btn active-real';
    post.className = 'mode-btn';
    document.body.style.setProperty('--moss', '#2d5b45');
    document.body.style.setProperty('--moss-light', '#3a7357');
  } else {
    real.className = 'mode-btn';
    post.className = 'mode-btn active-post';
    document.body.style.setProperty('--moss', '#5a4a2a');
    document.body.style.setProperty('--moss-light', '#7a6a3a');
  }
}

// Toolbar button toggling
document.querySelectorAll('.vp-tools .vp-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    btn.parentElement.querySelectorAll('.vp-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  });
});
</script>

</body>
</html>
